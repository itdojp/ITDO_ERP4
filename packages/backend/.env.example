DATABASE_URL="postgresql://user:password@localhost:5432/erp4"
# AUTH_MODE:
#   - jwt: require Authorization: Bearer token (default, recommended for production)
#   - hybrid: jwt when token is present, otherwise header
#   - header: use x-user-id/x-roles headers (DEV-ONLY / MOCK; DO NOT USE IN PRODUCTION)
AUTH_MODE="jwt"
# JWT configuration (OIDC/IDaaS)
# Set JWT_JWKS_URL or JWT_PUBLIC_KEY
JWT_JWKS_URL=""
JWT_PUBLIC_KEY=""
JWT_ISSUER=""
JWT_AUDIENCE=""
JWT_ALGS="RS256"
JWT_SUB_CLAIM="sub"
JWT_ROLE_CLAIM="roles"
JWT_GROUP_CLAIM="group_ids"
JWT_PROJECT_CLAIM="project_ids"
JWT_ORG_CLAIM="org_id"
AUTH_DEFAULT_ROLE="user"
# SCIM provisioning (Bearer token for /scim/v2/*)
# SECURITY:
#   - Treat SCIM_BEARER_TOKEN as a secret. Do NOT commit real values to source control.
#   - Store and inject this token via a secrets manager in production.
#   - Use a long, random, high-entropy value (32+ chars recommended).
#   - Rotate the token regularly and if exposure is suspected.
SCIM_BEARER_TOKEN="__SCIM_BEARER_TOKEN__"
SCIM_PAGE_MAX="200"
# MAIL_TRANSPORT:
#   - stub: send nothing (dev/test)
#   - smtp: send via SMTP_* settings below
#   - sendgrid: send via SendGrid API (SENDGRID_* settings below)
MAIL_TRANSPORT="stub"
MAIL_FROM="noreply@example.com"
# SMTP configuration examples. Replace with your own values and do NOT commit real SMTP credentials.
SMTP_HOST="smtp.example.com"
SMTP_PORT="587"
SMTP_SECURE="false"
SMTP_USER="user"
SMTP_PASS="__SMTP_PASSWORD__"
# SendGrid configuration (required when MAIL_TRANSPORT=sendgrid)
SENDGRID_API_KEY="__SENDGRID_API_KEY__"
SENDGRID_BASE_URL="https://api.sendgrid.com/v3"
# Optional SendGrid webhook shared secret (header: x-erp4-webhook-key)
SENDGRID_EVENT_WEBHOOK_SECRET=""
# SendGrid webhook limits
SENDGRID_EVENT_MAX_BYTES="1048576"
SENDGRID_EVENT_MAX_BATCH="500"
# Send log retry cooldown (minutes)
SEND_LOG_RETRY_COOLDOWN_MINUTES="5"
# PDF generation (local storage)
PDF_PROVIDER="local"
PDF_STORAGE_DIR="/tmp/erp4/pdfs"
# Optional base URL for returned pdfUrl (defaults to /pdf-files)
PDF_BASE_URL="http://localhost:3001/pdf-files"
# PDF asset loading limits
PDF_ASSET_ALLOWED_HOSTS=""
PDF_ASSET_MAX_BYTES="2097152"
PDF_DATA_URL_MAX_BYTES="2097152"
PDF_ASSET_TIMEOUT_MS="5000"
# External PDF provider (PDF_PROVIDER=external)
PDF_EXTERNAL_URL=""
PDF_EXTERNAL_API_KEY=""
PDF_EXTERNAL_MAX_BYTES="10485760"
PDF_EXTERNAL_TIMEOUT_MS="10000"

# Evidence Pack archive storage
# provider:
#   - local: store evidence archives on local filesystem
#   - s3: store evidence archives in S3-compatible object storage
EVIDENCE_ARCHIVE_PROVIDER="local"
EVIDENCE_ARCHIVE_LOCAL_DIR="/tmp/erp4/evidence-archives"
# S3 settings (required when EVIDENCE_ARCHIVE_PROVIDER=s3)
EVIDENCE_ARCHIVE_S3_BUCKET=""
# EVIDENCE_ARCHIVE_S3_REGION can be omitted when AWS_REGION/AWS_DEFAULT_REGION is set
EVIDENCE_ARCHIVE_S3_REGION=""
EVIDENCE_ARCHIVE_S3_PREFIX="erp4/evidence-pack"
EVIDENCE_ARCHIVE_S3_ENDPOINT_URL=""
EVIDENCE_ARCHIVE_S3_FORCE_PATH_STYLE="false"
EVIDENCE_ARCHIVE_S3_SSE=""
EVIDENCE_ARCHIVE_S3_KMS_KEY_ID=""

# External webhook notifications (Slack/Webhook)
# Disabled by default. To enable, set a comma-separated allowlist of hostnames.
# Example: WEBHOOK_ALLOWED_HOSTS="hooks.slack.com,example.com"
WEBHOOK_ALLOWED_HOSTS=""
WEBHOOK_TIMEOUT_MS="5000"
WEBHOOK_MAX_BYTES="1048576"
# DEV-ONLY overrides (avoid enabling in production unless you understand the risk)
WEBHOOK_ALLOW_HTTP="false"
WEBHOOK_ALLOW_PRIVATE_IP="false"

# WebPush (VAPID)
# Generate keys (example):
#   npx web-push generate-vapid-keys --json
VAPID_SUBJECT="mailto:admin@example.com"
VAPID_PUBLIC_KEY=""
VAPID_PRIVATE_KEY=""

# Chat attachments
# provider:
#   - local: store on local filesystem
#   - gdrive: store on Google Drive (see docs/requirements/chat-attachments-google-drive.md)
CHAT_ATTACHMENT_PROVIDER="local"
CHAT_ATTACHMENT_LOCAL_DIR="/tmp/erp4/chat-attachments"
CHAT_ATTACHMENT_MAX_BYTES="10485760"

# Chat attachment antivirus scanning
# provider: disabled|stub|eicar|clamav
CHAT_ATTACHMENT_AV_PROVIDER="disabled"
CLAMAV_HOST="127.0.0.1"
CLAMAV_PORT="3310"
CLAMAV_TIMEOUT_MS="10000"

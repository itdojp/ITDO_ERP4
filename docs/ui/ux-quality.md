# UI/UX 品質の最低ライン（a11y / 入力体験 / エラーメッセージ）

## 目的
- 入力ミス/操作不能/意味不明なエラーによる事故・手戻りを減らす
- 画面追加・改修のレビュー基準を統一する
- PoC/段階導入でも破綻しない「最低ライン」を先に固定する

## 適用範囲（現時点）
- PoC の主要導線（例: ダッシュボード/日報/工数/請求ドラフト）
- 以後の新規画面は本ドキュメントを満たすこと

## a11y（アクセシビリティ）最低ライン
- **キーボード操作**: 主要操作がマウス無しで完了できる（Tab/Shift+Tab/Enter/Escape）
- **フォーカス可視**: フォーカス位置が視認できる（`:focus-visible` 等）
- **ラベル**: 入力欄は「見出し/説明」ではなく、実入力に紐づくラベルを持つ（placeholder 依存は禁止）
- **操作要素の役割**: ボタン/リンク/入力は適切な要素/role を用いる
- **エラーの伝達**: エラーは色だけに依存せず、テキストで明示する

## 入力体験（フォーム）最低ライン
- **必須/任意**: ラベルまたはヘルプで明確化（必須ならその旨を表記）
- **バリデーション**:
  - 入力値の制約（桁/範囲/単位）は UI で明示（例: `min/max/step`、補足文）
  - フィールド単位のエラーは可能ならフィールドに紐づけて表示（inline）
  - 送信不可の理由が一目で分かる（サマリ表示でも可）

## エラーメッセージ（表示ルール）
### 種類
- **入力エラー（validation）**: ユーザが修正可能。画面内で完結する表現にする
- **サーバ/通信エラー（API）**: ユーザが修正できないことが多い。再試行/待機/問い合わせを促す
- **権限エラー（403 等）**: 何が不足かを明示（例: 「権限がありません」+ 対象）

### 表現
- 同種のエラーは同じ UI パターンで出す（例: validation は `Alert`、API は `Toast`）
- 文言は原則として「〜に失敗しました」または「入力内容を確認してください」に統一する
- 内部コード（例: `P2002`）はユーザ表示に直出ししない（必要ならログ/監査に残す）

## 回帰防止（チェック手段）
- **E2E（Playwright）**: 主要導線の「操作可能性」と「エラー表示の存在」を検証する
  - PR: `E2E_SCOPE=core`
  - main: `E2E_SCOPE=full`
- **レビュー時チェック**:
  - フォーム入力が `getByRole` / `getByLabel` で取得できる（ラベルが機能している）
  - 失敗時にユーザが次の行動を判断できる（再試行/修正/問い合わせ）

## 参考
- 品質ゲート: `docs/quality/quality-gates.md`


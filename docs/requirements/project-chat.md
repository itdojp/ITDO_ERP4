# ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒãƒ£ãƒƒãƒˆä»•æ§˜ï¼ˆçµ±åˆï¼‰

## ç›®çš„/ã‚¹ã‚³ãƒ¼ãƒ—
- ERPã¨çµ±åˆã•ã‚ŒãŸãƒãƒ£ãƒƒãƒˆæ©Ÿèƒ½ã¨ã—ã¦ã€Slack/Chatworkä»£æ›¿ã‚’ç›®æŒ‡ã™
- ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæƒ…å ±/ã‚¿ã‚¹ã‚¯/æ‰¿èªãªã©ERPã®æƒ…å ±ã¨é€£å‹•ã—ãŸåˆ©ç”¨ã‚’æƒ³å®šã™ã‚‹
- AIã‚’å–ã‚Šè¾¼ã¿ã€è¦ç´„/ã‚¢ã‚¯ã‚·ãƒ§ãƒ³æŠ½å‡ºãªã©ã®æ”¯æ´ã‚’è¡Œã†ï¼ˆè©³ç´°ã¯æ±ºå®šå¾…ã¡ï¼‰

## ç¾çŠ¶ï¼ˆå®Ÿè£…æ¸ˆã¿ï¼‰
- ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå˜ä½ã®ç°¡æ˜“ã‚°ãƒ«ãƒ¼ãƒ—ãƒãƒ£ãƒƒãƒˆ
- æŠ•ç¨¿/é–²è¦§/ã‚¿ã‚°/ãƒªã‚¢ã‚¯ã‚·ãƒ§ãƒ³/ãƒšãƒ¼ã‚¸ãƒ³ã‚°ã®ã¿
- ç›£æŸ»/é€šçŸ¥/ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ é…ä¿¡/æ·»ä»˜/æ¤œç´¢ã¯æœªå®Ÿè£…

## å½¹å‰²/ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡
- è¨±å¯ãƒ­ãƒ¼ãƒ«: admin / mgmt / user / hr / exec / external_chat
- admin/mgmt ã¯å…¨ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½
- ãã‚Œä»¥å¤–ã®ãƒ­ãƒ¼ãƒ«ã¯ `projectIds` ã«å«ã¾ã‚Œã‚‹æ¡ˆä»¶ã®ã¿ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½
- `external_chat` ã¯ãƒãƒ£ãƒƒãƒˆã®ã¿åˆ©ç”¨å¯ï¼ˆä»–æ©Ÿèƒ½ã¯ä¸å¯ï¼‰

## æ±ºå®šäº‹é …ï¼ˆè¦‹ç›´ã—åæ˜ ï¼‰
- æ—¢èª­/æœªèª­çŠ¶æ…‹ã‚’ä¿æŒã™ã‚‹
- æ—¢èª­çŠ¶æ…‹ã‚’ä»–ã®ãƒ¦ãƒ¼ã‚¶ã«è¦‹ã›ã‚‹ã‹ã¯ã€Œãƒãƒ£ãƒƒãƒˆå˜ä½ã€ã§ç®¡ç†è€…ãŒé¸æŠå¯èƒ½
- ãƒ¡ãƒ³ã‚·ãƒ§ãƒ³ã¯å¿…é ˆ
- æœ¬æ–‡ã¯Markdownã§è¨˜è¿°ã™ã‚‹
- é€šçŸ¥/æ·»ä»˜/æ¤œç´¢ã¯ERPçµ±åˆã¨ã—ã¦æœ›ã¾ã—ã„å½¢ã§è¨­è¨ˆã™ã‚‹ï¼ˆåŸå‰‡ã®ã¿æ±ºå®šã€‚è©³ç´°ãªæ–¹å¼ã¯ã€Œæœªæ±ºå®š/è¦è¨­è¨ˆã€ã‚’å‚ç…§ï¼‰
- ç›£æŸ»ç›®çš„ã® break-glassï¼ˆç›£æŸ»é–²è¦§ï¼‰ã‚’æä¾›ã™ã‚‹ï¼ˆç†ç”±å¿…é ˆ + ç›£æŸ»ãƒ­ã‚°å¿…é ˆ + äºŒé‡æ‰¿èªã‚’æƒ³å®šï¼‰
  - break-glass ã‚’ä½¿ã£ãŸäº‹å®ŸãŒåˆ†ã‹ã‚‹ä»•çµ„ã¿ã‚’å…¥ã‚Œã‚‹ï¼ˆãƒãƒŠãƒ¼/ã‚·ã‚¹ãƒ†ãƒ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸/å±¥æ­´ï¼‰
- æŠ•ç¨¿å†…å®¹ã¯å®Œå…¨å‰Šé™¤ã§ããªã„ï¼ˆè«–ç†å‰Šé™¤ + ç›£æŸ»ä¿å…¨ã€‚å‰Šé™¤ã—ã¦ã‚‚ç›£æŸ»ä¸Šã¯è¿½è·¡å¯èƒ½ï¼‰
- å¤–éƒ¨é€£æºï¼ˆWebhook/å¤–éƒ¨é€šçŸ¥ãªã©ï¼‰ã¯å…¬å¼ãƒ«ãƒ¼ãƒ ã®ã¿è¨±å¯ã™ã‚‹

## æœªæ±ºå®š/è¦è¨­è¨ˆ
- ãƒãƒ£ãƒƒãƒˆå˜ä½ã®å®šç¾©ï¼ˆãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆé™å®šã‹ã€éƒ¨é–€/å…¨ç¤¾/DMã‚’å«ã‚ã‚‹ã‹ï¼‰
- æ—¢èª­è¡¨ç¤ºã®ç²’åº¦ï¼ˆæ—¢èª­è€…ä¸€è¦§/äººæ•°ã®ã¿/éè¡¨ç¤ºï¼‰
- ãƒ¡ãƒ³ã‚·ãƒ§ãƒ³ã®ç¨®é¡ï¼ˆãƒ¦ãƒ¼ã‚¶/ãƒ­ãƒ¼ãƒ«/ã‚°ãƒ«ãƒ¼ãƒ—/ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆï¼‰
- Markdownæ–¹è¨€ï¼ˆCommonMark/GFMãªã©ï¼‰ã¨ã‚µãƒ‹ã‚¿ã‚¤ã‚ºæ–¹é‡
- æ·»ä»˜ã®ä¿å­˜å…ˆ/æ¨©é™åˆ¶å¾¡/å®¹é‡ä¸Šé™/ã‚¦ã‚¤ãƒ«ã‚¹ã‚¹ã‚­ãƒ£ãƒ³
- æ¤œç´¢ã®å¯¾è±¡ç¯„å›²ï¼ˆãƒãƒ£ãƒƒãƒˆã®ã¿/ERPæ¨ªæ–­/æ·»ä»˜å«ã‚€ï¼‰
- é€šçŸ¥ãƒãƒ£ãƒãƒ«ï¼ˆã‚¢ãƒ—ãƒªå†…/ãƒ¡ãƒ¼ãƒ«/Push/å¤–éƒ¨é€£æºï¼‰ã¨é€šçŸ¥æ¡ä»¶
- AIæ©Ÿèƒ½ã®ç¯„å›²ï¼ˆè¦ç´„/ã‚¢ã‚¯ã‚·ãƒ§ãƒ³æŠ½å‡º/FAQ/æ¤œç´¢æ”¯æ´ãªã©ï¼‰ã¨æ¨©é™/ç›£æŸ»
- å¤–éƒ¨ãƒ¦ãƒ¼ã‚¶ï¼ˆexternal_chatï¼‰ã®å‚åŠ ç¯„å›²/åˆ¶é™

## ã‚¬ãƒãƒŠãƒ³ã‚¹è¨­è¨ˆï¼ˆæ¡ˆï¼‰
### ãƒ«ãƒ¼ãƒ ã®ç¨®åˆ¥
- å…¬å¼ãƒ«ãƒ¼ãƒ ï¼ˆä¼šç¤¾ãŒæŠŠæ¡ãƒ»çµ±åˆ¶ã™ã‚‹å‰æï¼‰
  - ä¾‹: æ¡ˆä»¶ãƒ«ãƒ¼ãƒ ï¼ˆProjectï¼‰ã€éƒ¨é–€/å…¨ç¤¾ãƒ«ãƒ¼ãƒ ï¼ˆGroup/Roleï¼‰
  - å¤–éƒ¨é€£æºï¼ˆWebhookç­‰ï¼‰ã‚’è¨±å¯ã§ãã‚‹ã®ã¯å…¬å¼ãƒ«ãƒ¼ãƒ ã®ã¿
- ç§çš„ãƒ«ãƒ¼ãƒ ï¼ˆè‡ªæ²»ã‚’åŸºæœ¬ã¨ã™ã‚‹ãŒã€ä¼šç¤¾ãŒç›£æŸ»ã§ãã‚‹å‰æï¼‰
  - DM/éå…¬å¼ã‚°ãƒ«ãƒ¼ãƒ—ç­‰ã®å¯å¦ã¯è¦æ±ºå®šï¼ˆãŸã ã—ã€Œå­˜åœ¨ã€ã¯ä¼šç¤¾å´ã§æŠŠæ¡ã§ãã‚‹è¨­è¨ˆã«ã™ã‚‹ï¼‰
  - ç§çš„ãƒ«ãƒ¼ãƒ ã¯å¤–éƒ¨é€£æºã‚’ç¦æ­¢ï¼ˆå¤–éƒ¨é€£æºãŒå¿…è¦ãªã‚‰å…¬å¼ãƒ«ãƒ¼ãƒ ã¨ã—ã¦ä½œæˆã™ã‚‹ï¼‰

### ã€Œä¼šç¤¾ãŒèªçŸ¥ã™ã‚‹ã€ç¯„å›²ï¼ˆæ±ºå®š: Bï¼‰
- ä¼šç¤¾ï¼ˆadmin/mgmt/ç›£æŸ»æ¨©é™è€…ï¼‰ã¯ã€ãƒ«ãƒ¼ãƒ ã®å­˜åœ¨ã¨ãƒ¡ãƒ³ãƒãƒ¼ç­‰ã®ãƒ¡ã‚¿æƒ…å ±ã‚’æŠŠæ¡ã§ãã‚‹
- ç›£æŸ»ç›®çš„ã® break-glassï¼ˆç†ç”±+ãƒ­ã‚°+æ‰¿èªï¼‰ã«ã‚ˆã‚Šã€å¿…è¦æ™‚ã¯å†…å®¹ã‚‚é–²è¦§ã§ãã‚‹

### ç§çš„ã‚°ãƒ«ãƒ¼ãƒ—ã®è‡ªæ²»ï¼ˆæ¡ˆï¼‰
- ç§çš„ã‚°ãƒ«ãƒ¼ãƒ—ã¯ã€ãƒ«ãƒ¼ãƒ å†…ã®ç®¡ç†è€…ï¼ˆroom admin/ownerï¼‰ã‚’å¿…é ˆã¨ã™ã‚‹
  - å‚åŠ è€…ã®æ‹›å¾…/é€€å‡ºã€ãƒ«ãƒ¼ãƒ è¨­å®šå¤‰æ›´ã®è²¬ä»»ã‚’æŒã¤
  - ç®¡ç†è€…ãŒä¸åœ¨ã«ãªã‚‰ãªã„ã‚ˆã†ã«ã€é€€å‡ºæ™‚ã¯ç®¡ç†è€…ç§»è­²ã‚’å¿…é ˆã«ã™ã‚‹
- ä¼šç¤¾è²¬ä»»ã¨ã®ãƒˆãƒ¬ãƒ¼ãƒ‰ã‚ªãƒ•
  - é‹ç”¨ã¯è‡ªæ²»ï¼ˆä¼šç¤¾ãŒå¸¸æ™‚ç›£è¦–ã—ãªã„ï¼‰ã¨ã—ã¤ã¤ã€ç›£æŸ»ãƒ»èª¿æŸ»ã®å¿…è¦ãŒç”Ÿã˜ãŸå ´åˆã« break-glass ã‚’è¡Œãˆã‚‹çŠ¶æ…‹ã«ã™ã‚‹
  - ä¼šç¤¾å´ã®å¼·åˆ¶æªç½®ï¼ˆå¼·åˆ¶ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–/å‡çµ/é€€ä¼šãªã©ï¼‰ãŒå¿…è¦ã«ãªã‚‹å ´åˆã¯ã€ã™ã¹ã¦ç†ç”±å¿…é ˆ + ç›£æŸ»ãƒ­ã‚°å¿…é ˆ

### å¤–éƒ¨é€£æºï¼ˆæ±ºå®šï¼‰
- å¤–éƒ¨é€£æºã§ãã‚‹ã®ã¯å…¬å¼ãƒ«ãƒ¼ãƒ ã®ã¿
  - ç§çš„ãƒ«ãƒ¼ãƒ ã¯ã€å¤–éƒ¨ãƒ¦ãƒ¼ã‚¶æ‹›å¾…ã‚„å¤–éƒ¨é€šçŸ¥/Webhookã‚’ç¦æ­¢ã™ã‚‹
  - AIãŒå¤–éƒ¨LLMç­‰ã«é€ä¿¡ã™ã‚‹æ–¹å¼ã®å ´åˆã¯ã€Œå¤–éƒ¨é€£æºã€ã¨ã¿ãªã—ã€å…¬å¼ãƒ«ãƒ¼ãƒ ã®ã¿è¨±å¯ï¼ˆç§çš„ãƒ«ãƒ¼ãƒ ã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆç„¡åŠ¹ï¼‰

## ç›£æŸ»ç›®çš„ break-glassï¼ˆæ¡ˆï¼‰
### ç›®çš„
- ä¸æ­£/ãƒãƒ©ã‚¹ãƒ¡ãƒ³ãƒˆ/æƒ…å ±æ¼ãˆã„ç­‰ã®èª¿æŸ»ã€ç›£æŸ»å¯¾å¿œã®ãŸã‚ã«ã€ç§çš„ãƒ«ãƒ¼ãƒ ã‚’å«ã‚€ãƒãƒ£ãƒƒãƒˆå†…å®¹ã¸ä¾‹å¤–çš„ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ä»•çµ„ã¿ã‚’æä¾›ã™ã‚‹

### ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ï¼ˆæ¡ˆï¼‰
1. ç›£æŸ»é–²è¦§ç”³è«‹ï¼ˆrequestï¼‰
   - ç”³è«‹è€…: admin/mgmt/execï¼ˆè©³ç´°ã¯è¦æ±ºå®šï¼‰
   - å…¥åŠ›: reasonCode + reasonTextï¼ˆå¿…é ˆï¼‰ã€å¯¾è±¡ãƒ«ãƒ¼ãƒ ã€å¯¾è±¡æœŸé–“ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆä¾‹: 30æ—¥ï¼‰ã€é–²è¦§æœŸé–“ï¼ˆTTLï¼‰
2. äºŒé‡æ‰¿èªï¼ˆapproveï¼‰
   - ä¾‹: mgmt + exec ã®äºŒé‡æ‰¿èªï¼ˆè¦æ±ºå®šï¼‰
3. é–²è¦§è¨±å¯ï¼ˆgrantï¼‰
   - è¨±å¯ã•ã‚ŒãŸç›£æŸ»è€…ã®ã¿é–²è¦§å¯èƒ½
   - é–²è¦§å¯èƒ½æœŸé–“ï¼ˆä¾‹: 24hï¼‰ã‚’éããŸã‚‰è‡ªå‹•å¤±åŠ¹
4. é–²è¦§å®Ÿè¡Œï¼ˆaccessï¼‰
   - å®Ÿéš›ã«é–²è¦§ã—ãŸäº‹å®Ÿï¼ˆèª°ãŒ/ã„ã¤/ã©ã®ç¯„å›²ï¼‰ã‚’ç›£æŸ»ãƒ­ã‚°ã¸è¨˜éŒ²

### ã€Œäº‹å‰ã«åˆ†ã‹ã‚‹ã€ä»•çµ„ã¿ï¼ˆæ¡ˆï¼‰
- ç›£æŸ»é–²è¦§ãŒç”³è«‹/æ‰¿èªã•ã‚ŒãŸæ™‚ç‚¹ã§ã€ãƒ«ãƒ¼ãƒ å†…ã«ã‚·ã‚¹ãƒ†ãƒ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ»ãƒãƒŠãƒ¼ã‚’è¡¨ç¤ºã—ã¦é€šçŸ¥ã™ã‚‹
- å°‘ãªãã¨ã‚‚ãƒ«ãƒ¼ãƒ ç®¡ç†è€…ï¼ˆç§çš„ãƒ«ãƒ¼ãƒ ã®ç®¡ç†è€…ï¼‰ã«ã¯å¿…ãšé€šçŸ¥ã™ã‚‹
- ç›£æŸ»ç›®çš„ã¨ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ã®ãƒãƒ©ãƒ³ã‚¹ã®ãŸã‚ã€é€šçŸ¥ã®ç²’åº¦ï¼ˆå…¨å“¡/ç®¡ç†è€…ã®ã¿ï¼‰ã¨è¡¨ç¤ºå†…å®¹ï¼ˆç†ç”±å…¨æ–‡ã‚’å‡ºã™ã‹ï¼‰ã¯è¨­å®šã§åˆ¶å¾¡ï¼ˆè¦æ±ºå®šï¼‰
- ã€Œäº‹å‰ã€ã‚’æ‹…ä¿ã™ã‚‹ãŸã‚ã«ã€æ‰¿èªâ†’é–²è¦§æ¨©ä»˜ä¸ã®å‰ã«å¿…ãšé€šçŸ¥ã‚’è¡¨ç¤ºã™ã‚‹ï¼ˆé€šçŸ¥è¡¨ç¤ºã¨é–²è¦§æ¨©ä»˜ä¸ã¯åŒä¸€ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã§ç¢ºå®šï¼‰
  - è¿½åŠ æ¡ˆ: é€šçŸ¥å¾Œã«ä¸€å®šã®çŒ¶äºˆæ™‚é–“ï¼ˆcooldownï¼‰ã‚’ç½®ã„ã¦ã‹ã‚‰é–²è¦§å¯èƒ½ã«ã™ã‚‹ï¼ˆè¦æ±ºå®šï¼‰

### break-glass ã‚’ä½¿ã£ãŸã“ã¨ãŒåˆ†ã‹ã‚‹ä»•çµ„ã¿ï¼ˆæ¡ˆï¼‰
- é–²è¦§ç”³è«‹/æ‰¿èª/é–²è¦§é–‹å§‹/é–²è¦§çµ‚äº†ã®ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§ã€Œã‚·ã‚¹ãƒ†ãƒ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã€ã‚’æ®‹ã™
  - ã‚·ã‚¹ãƒ†ãƒ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¯å‰Šé™¤ä¸å¯ï¼ˆé–²è¦§ã®äº‹å®ŸãŒæ¶ˆãˆãªã„ï¼‰
  - å°‘ãªãã¨ã‚‚ãƒ«ãƒ¼ãƒ ç®¡ç†è€…ã¯å¿…ãšè¦–èªã§ãã‚‹ï¼ˆå…¨å“¡è¡¨ç¤ºã¯è¦æ±ºå®šï¼‰
- ç›£æŸ»é–²è¦§ã®å±¥æ­´ï¼ˆrequestIdã€ç”³è«‹è€…ã€æ‰¿èªè€…ã€é–²è¦§è€…ã€å¯¾è±¡æœŸé–“ã€å®Ÿè¡Œæ—¥æ™‚ã€ç†ç”±ï¼‰ã‚’ãƒ«ãƒ¼ãƒ è¨­å®š/ç›£æŸ»ç”»é¢ã‹ã‚‰å‚ç…§ã§ãã‚‹

### æ”¹ã–ã‚“ãƒ»å‰Šé™¤å¯¾ç­–ï¼ˆæ¡ˆï¼‰
- ãƒãƒ£ãƒƒãƒˆã¯ãƒãƒ¼ãƒ‰ãƒ‡ãƒªãƒ¼ãƒˆç¦æ­¢ï¼ˆå¾Œè¿°ï¼‰
- break-glass ã®ç”³è«‹/æ‰¿èª/é–²è¦§ã¯å‰Šé™¤ä¸å¯ã®ç›£æŸ»ãƒ­ã‚°ã¨ã—ã¦æ®‹ã™
- ç›£æŸ»ãƒ­ã‚°ã¯æ—¢å­˜ã®æ”¹ã–ã‚“æ¤œçŸ¥ï¼ˆãƒãƒƒã‚·ãƒ¥ãƒã‚§ãƒ¼ãƒ³/å¤–éƒ¨ä¿å…¨æ–¹é‡ï¼‰ã¨æ•´åˆã•ã›ã‚‹

## å‰Šé™¤/ç·¨é›†/ä¿æŒï¼ˆæ¡ˆï¼‰
- æŠ•ç¨¿ã¯åŸå‰‡ã€Œç·¨é›†ã€ã§ã¯ãªãã€Œè¿½è¨˜ã€ã‚’æ¨å¥¨ï¼ˆé‹ç”¨/UXã¯è¦æ¤œè¨ï¼‰
- ç·¨é›†ã‚’è¨±å¯ã™ã‚‹å ´åˆã¯ revision ã‚’ä¿æŒã—ã€ç›£æŸ»é–²è¦§ã§ã¯æ”¹ç‰ˆå±¥æ­´ã‚‚é–²è¦§ã§ãã‚‹
- å‰Šé™¤ã¯è«–ç†å‰Šé™¤ï¼ˆè¡¨ç¤ºä¸Šã¯ã€Œå‰Šé™¤æ¸ˆã¿ã€ã«ç½®æ›ï¼‰ã¨ã—ã€åŸæ–‡ã¯ç›£æŸ»ä¸Šã®è¿½è·¡ãŒå¯èƒ½ãªå½¢ã§ä¿æŒã™ã‚‹
  - ãƒ¦ãƒ¼ã‚¶å‘ã‘ã«ã¯å‰Šé™¤ã§ããŸã‚ˆã†ã«è¦‹ãˆã¦ã‚‚ã€ç›£æŸ»ç›®çš„ã®é–²è¦§ã‚„ç›£æŸ»ãƒ­ã‚°ã§ã¯è¿½è·¡å¯èƒ½ï¼ˆå®Œå…¨å‰Šé™¤ã¯ä¸å¯ï¼‰

## ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«
### ProjectChatMessage
- `id`: UUID
- `projectId`: å‚ç…§å…ˆ `Project`
- `userId`: æŠ•ç¨¿è€…ã®ID
- `body`: ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸æœ¬æ–‡
- `tags`: JSONé…åˆ—ï¼ˆæ–‡å­—åˆ—ã®ã‚¿ã‚°ä¸€è¦§ï¼‰
- `reactions`: JSONãƒãƒƒãƒ—ï¼ˆemoji -> { count, userIds[] }ï¼‰
- `createdAt/createdBy`, `updatedAt/updatedBy`
- `deletedAt/deletedReason`ï¼ˆè«–ç†å‰Šé™¤ç”¨ã€APIæœªå®Ÿè£…ï¼‰

### ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹
- `projectId, createdAt`

## ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«ï¼ˆæ‹¡å¼µæ¡ˆï¼‰
- ChatRoomï¼ˆtype, name, projectId?, readReceiptMode, createdBy ãªã©ï¼‰
- ChatRoomMemberï¼ˆroomId, userId, role, lastReadAt ãªã©ï¼‰
- ChatMessageï¼ˆroomId, userId, bodyMarkdown, createdAt ãªã©ï¼‰â€»Markdownæœ¬æ–‡
- ChatMessageReadï¼ˆmessageId, userId, readAtï¼‰â€»æ—¢èª­è¡¨ç¤ºã®ç²’åº¦æ¬¡ç¬¬
- ChatAttachmentï¼ˆmessageId, storageKey, fileName, mime, size ãªã©ï¼‰
- ChatMentionï¼ˆmessageId, targetType, targetId ãªã©ï¼‰â€»ä¾‹: targetType = 'user' | 'group'
- ChatBreakGlassRequestï¼ˆroomId, requestedBy, reasonCode, reasonText, status, approvedBy, approvedAt, grantedAt, expiresAt ãªã©ï¼‰
- ChatBreakGlassEventï¼ˆrequestId, actorUserId, action, at, scope ãªã©ï¼‰

## API
### ç¾è¡ŒAPI
### GET `/projects/:projectId/chat-messages`
**Query**
- `limit` (default 50, max 200)
- `before` (ISOæ—¥æ™‚ã€‚ã“ã‚Œä»¥å‰ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å–å¾—)
- `tag` (ä»»æ„ã€‚ã‚¿ã‚°ãŒä¸€è‡´ã™ã‚‹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ã¿)

**æŒ™å‹•**
- `createdAt` é™é †ã§å–å¾—
- `tag` ã¯ãƒˆãƒªãƒ å¾Œã®å®Œå…¨ä¸€è‡´ã§ãƒ•ã‚£ãƒ«ã‚¿
- `tag` ãŒç©º/æœªæŒ‡å®šã®å ´åˆã¯ãƒ•ã‚£ãƒ«ã‚¿ãªã—

**ã‚¨ãƒ©ãƒ¼**
- `limit` ãŒæ­£æ•°ã§ãªã„å ´åˆã¯ 400
- `before` ãŒä¸æ­£ãªæ—¥ä»˜ã®å ´åˆã¯ 400
- `tag` ãŒ 32 æ–‡å­—è¶…ã®å ´åˆã¯ 400

### POST `/projects/:projectId/chat-messages`
**Body**
- `body` (1ã€œ2000æ–‡å­—)
- `tags` (ä»»æ„: 0ã€œ8ä»¶ã€å„32æ–‡å­—ã¾ã§)

**æŒ™å‹•**
- `userId` ã¯èªè¨¼æƒ…å ±ã‹ã‚‰å–å¾—
- èªè¨¼æƒ…å ±ãŒä¸è¶³ã™ã‚‹å ´åˆã¯ `demo-user` ã‚’ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ï¼ˆPoCå‘ã‘ï¼‰
  - æœ¬ç•ªç’°å¢ƒã§ã¯ç„¡åŠ¹åŒ–ã—ã€401/403 ã‚’è¿”ã™å‰æ
  - `demo-user` ã¯æ˜ç¤ºçš„ãªè¨­å®šãƒ•ãƒ©ã‚°ã§ã®ã¿æœ‰åŠ¹åŒ–ã™ã‚‹

### POST `/chat-messages/:id/reactions`
**Body**
- `emoji` (1ã€œ16æ–‡å­—)

**æŒ™å‹•**
- åŒä¸€ãƒ¦ãƒ¼ã‚¶ã®åŒä¸€emojiã¯1å›ã®ã¿åŠ ç®—
- å½¢å¼ã¯ `{ emoji: { count, userIds[] } }`
- æ—¢å­˜ãƒ‡ãƒ¼ã‚¿ãŒæ•°å€¤ã®å ´åˆã¯äº’æ›æ‰±ã„ã§æ›´æ–°ã™ã‚‹

### æ‹¡å¼µAPIï¼ˆæ¡ˆï¼‰
- `GET /chat-rooms`ï¼ˆå‚åŠ å¯èƒ½ãªãƒãƒ£ãƒƒãƒˆä¸€è¦§ï¼‰
- `POST /chat-rooms`ï¼ˆæ–°è¦ä½œæˆ/è¨­å®šï¼‰
- `GET /chat-rooms/:id/messages`ï¼ˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å–å¾—ï¼‰
- `POST /chat-rooms/:id/messages`ï¼ˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸æŠ•ç¨¿ï¼‰
- `POST /chat-rooms/:id/read`ï¼ˆæ—¢èª­æ›´æ–°ï¼‰
- `GET /chat-rooms/:id/unread-counts`ï¼ˆæœªèª­ä»¶æ•°ï¼‰
- `POST /chat-messages/:id/attachments`ï¼ˆæ·»ä»˜ï¼‰
- `GET /chat-search?q=`ï¼ˆæ¤œç´¢ï¼‰
- `POST /chat-break-glass/requests`ï¼ˆç›£æŸ»é–²è¦§ç”³è«‹ï¼‰
- `POST /chat-break-glass/requests/:id/approve|reject`ï¼ˆæ‰¿èª/å´ä¸‹ï¼‰
- `GET /chat-break-glass/requests`ï¼ˆç”³è«‹ä¸€è¦§/å±¥æ­´ï¼‰

## UIï¼ˆProjectChatï¼‰
- ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆé¸æŠã€èª­ã¿è¾¼ã¿ã€æŠ•ç¨¿ã€ã‚¿ã‚°è¡¨ç¤ºã€ãƒªã‚¢ã‚¯ã‚·ãƒ§ãƒ³
- ã‚¿ã‚°çµã‚Šè¾¼ã¿å…¥åŠ›ï¼ˆé©ç”¨ã¯ã€Œèª­ã¿è¾¼ã¿ã€ãƒœã‚¿ãƒ³ï¼‰
- è¿½åŠ èª­ã¿è¾¼ã¿ï¼ˆ`before` ä½¿ç”¨ï¼‰
- æ—¢å®šã®ãƒªã‚¢ã‚¯ã‚·ãƒ§ãƒ³å€™è£œ: ğŸ‘/ğŸ‰/â¤ï¸/ğŸ˜‚/ğŸ™/ğŸ‘€

## UIï¼ˆæ‹¡å¼µæ–¹é‡ï¼‰
- æœªèª­/æ—¢èª­è¡¨ç¤ºï¼ˆè¨­å®šã«å¿œã˜ã¦è¡¨ç¤ºæ–¹å¼ã‚’åˆ‡æ›¿ï¼‰
- ãƒ¡ãƒ³ã‚·ãƒ§ãƒ³å…¥åŠ›æ”¯æ´
- Markdownãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼
- æ·»ä»˜/æ¤œç´¢/é€šçŸ¥è¨­å®šã®å°ç·š
- AIæ”¯æ´ï¼ˆè¦ç´„/ã‚¢ã‚¯ã‚·ãƒ§ãƒ³æŠ½å‡ºï¼‰è¡¨ç¤ºã®å°ç·š
- break-glass ã®ãƒãƒŠãƒ¼/å±¥æ­´è¡¨ç¤ºï¼ˆãƒ«ãƒ¼ãƒ å˜ä½ï¼‰
- ç›£æŸ»è€…å‘ã‘ã®ç”³è«‹/æ‰¿èª/é–²è¦§UIï¼ˆç®¡ç†ç”»é¢ã¾ãŸã¯ç›£æŸ»ç”»é¢ï¼‰

## ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³/åˆ¶ç´„
- æœ¬æ–‡: 1ã€œ2000æ–‡å­—
- ã‚¿ã‚°: æœ€å¤§8ä»¶ã€å„32æ–‡å­—
- ãƒªã‚¢ã‚¯ã‚·ãƒ§ãƒ³emoji: 1ã€œ16æ–‡å­—

## ãƒ†ã‚¹ãƒˆ
- E2Eã‚¹ãƒ¢ãƒ¼ã‚¯ã«ã€ŒæŠ•ç¨¿/ãƒªã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã€å«ã‚€
  - `packages/frontend/e2e/frontend-smoke.spec.ts`

## æœªå®Ÿè£…/å¾Œç¶šã‚¹ã‚³ãƒ¼ãƒ—
- ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ç·¨é›†/å‰Šé™¤ï¼ˆè«–ç†å‰Šé™¤APIï¼‰
- ãƒªã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã®å–ã‚Šæ¶ˆã—ï¼ˆãƒˆã‚°ãƒ«ï¼‰
- æ·»ä»˜/ç”»åƒ/ãƒ•ã‚¡ã‚¤ãƒ«
- ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–°ï¼ˆWS/ãƒãƒ¼ãƒªãƒ³ã‚°ï¼‰
- ãƒ¡ãƒ³ã‚·ãƒ§ãƒ³/é€šçŸ¥é€£æºï¼ˆè¨­è¨ˆä¸­ãƒ»æ±ºå®šäº‹é …/æœªæ±ºå®šã‚»ã‚¯ã‚·ãƒ§ãƒ³ã«åŸºã¥ãå¾Œç¶šå®Ÿè£…ï¼‰
- æ—¢èª­/æœªèª­ã®è¡¨ç¤º/è¨­å®šï¼ˆè¨­è¨ˆä¸­ãƒ»æ±ºå®šäº‹é …/æœªæ±ºå®šã‚»ã‚¯ã‚·ãƒ§ãƒ³ã«åŸºã¥ãå¾Œç¶šå®Ÿè£…ï¼‰
- è¤‡æ•°ã‚¿ã‚°ã® AND/OR æ¤œç´¢

## é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
- `docs/requirements/data-model-sketch.md`
- `docs/requirements/domain-api-draft.md`
- `docs/requirements/frontend-api-wire.md`
- `docs/requirements/rbac-matrix.md`
- `docs/requirements/access-control.md`
